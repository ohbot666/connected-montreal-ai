<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{{ first }} {{ last }} ‚Äî Connected Montreal Quote</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,400;0,600;0,700;1,400;1,600&display=swap" rel="stylesheet">
<style>
  /* ‚îÄ‚îÄ Reset ‚îÄ‚îÄ */
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: 'Montserrat', Helvetica, Arial, sans-serif;
    background: #fff;
    color: #000;
    font-size: 13px;
    line-height: 1.6;
    padding-bottom: 72px;
  }
  a { color: #0000EE; }
  img { max-width: 100%; display: block; }

  /* ‚îÄ‚îÄ Layout ‚îÄ‚îÄ */
  .container {
    max-width: 680px;
    margin: 0 auto;
    padding: 0 20px;
  }
  @media (min-width: 600px) {
    .container { padding: 0 40px; }
  }

  /* ‚îÄ‚îÄ Hero ‚îÄ‚îÄ */
  .hero { overflow: hidden; max-height: 220px; }
  .hero img { width: 100%; display: block; object-fit: cover; object-position: center top; }

  /* ‚îÄ‚îÄ AS SEEN IN ‚îÄ‚îÄ */
  .press-section {
    text-align: center;
    padding: 12px 16px;
    border-bottom: 1px solid #e8e8e8;
  }
  .press-label {
    font-size: 9px;
    font-weight: 700;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: #757575;
    margin-bottom: 7px;
  }
  .press-logos {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 24px;
    flex-wrap: wrap;
  }
  .press-logos img {
    height: 26px;
    opacity: 1;
  }

  /* ‚îÄ‚îÄ Client Intro ‚îÄ‚îÄ */
  .client-intro {
    text-align: center;
    padding: 18px 20px 16px;
    border-bottom: 1px solid #e8e8e8;
  }
  .client-name {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 4px;
  }
  @media (min-width: 600px) { .client-name { font-size: 26px; } }
  .client-meta { font-size: 13px; color: #757575; line-height: 1.5; margin-bottom: 12px; }
  .client-note {
    background: #fffbea;
    border: 1px solid #f0d080;
    border-radius: 10px;
    padding: 20px 22px;
    max-width: 560px;
    margin: 0 auto;
    text-align: left;
  }
  .client-note .note-label {
    font-weight: 700;
    font-size: 14px;
    color: #7a5c00;
    margin-bottom: 12px;
  }
  .client-note ul {
    margin: 0;
    padding: 0;
    list-style: none;
    display: flex;
    flex-direction: column;
    gap: 8px;
  }
  .client-note ul li {
    font-size: 14px;
    color: #5a4400;
    line-height: 1.5;
    display: flex;
    gap: 8px;
  }
  .client-note ul li .note-bullet {
    flex-shrink: 0;
  }

  /* ‚îÄ‚îÄ Section titles ‚îÄ‚îÄ */
  .section { padding-bottom: 18px; border-bottom: 1px solid #e8e8e8; }
  .section-title {
    font-family: Georgia, 'Times New Roman', serif;
    font-size: 14px;
    font-weight: 400;
    letter-spacing: 4px;
    text-transform: uppercase;
    text-align: center;
    margin: 20px 0 14px;
    color: #000;
  }
  @media (min-width: 600px) { .section-title { font-size: 15px; letter-spacing: 5px; } }
  .section-title.bordered {
    border: 1px solid #000;
    padding: 8px 16px;
    display: inline-block;
    width: 100%;
  }

  /* ‚îÄ‚îÄ Accommodations ‚îÄ‚îÄ */
  .accom-heading { font-size: 13px; font-weight: 700; margin-bottom: 6px; }
  .accom-stats {
    display: flex;
    flex-wrap: wrap;
    gap: 6px 16px;
    font-size: 12px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #333;
  }
  .accom-stats span { white-space: nowrap; }
  .accom-sub { font-size: 11px; margin-bottom: 12px; line-height: 1.7; }
  .accom-img { width: 100%; margin-top: 12px; }

  /* ‚îÄ‚îÄ Services ‚îÄ‚îÄ */
  .service-block { margin-bottom: 12px; }
  .service-heading { font-size: 13px; font-weight: 700; margin-bottom: 5px; }
  .checklist { list-style: none; }
  .checklist li {
    display: flex;
    gap: 8px;
    font-size: 12px;
    margin-bottom: 5px;
    align-items: flex-start;
  }
  .checklist li::before { content: "‚úî"; font-size: 11px; margin-top: 1px; flex-shrink: 0; }
  .service-body { font-size: 12px; line-height: 1.6; }

  /* ‚îÄ‚îÄ Events / Itinerary ‚îÄ‚îÄ */
  .day-header { font-size: 13px; font-weight: 700; margin: 16px 0 8px; }
  @media (min-width: 600px) { .day-header { font-size: 14px; } }
  .event-row { display: flex; gap: 16px; margin-bottom: 12px; align-items: flex-start; }
  .event-time { font-size: 12px; font-weight: 600; min-width: 68px; flex-shrink: 0; padding-top: 1px; }
  .event-name { font-size: 13px; font-weight: 700; margin-bottom: 3px; }
  .event-desc { font-size: 11px; color: #757575; line-height: 1.55; }

  /* ‚îÄ‚îÄ Grand Total ‚îÄ‚îÄ */
  .grand-total-box {
    background: #000;
    color: #fff;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 18px 20px 0;
    margin-top: 18px;
  }
  @media (min-width: 480px) { .grand-total-box { padding: 20px 28px 0; } }
  .gt-label { font-size: 9px; font-weight: 600; letter-spacing: 1.5px; text-transform: uppercase; color: #aaa; margin-bottom: 3px; }
  .gt-value { font-size: 26px; font-weight: 700; }
  @media (min-width: 480px) { .gt-value { font-size: 30px; } }
  .gt-value-sm { font-size: 18px; font-weight: 600; color: #333; }
  @media (min-width: 480px) { .gt-value-sm { font-size: 20px; } }
  .gt-total-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0 4px;
    border-bottom: 1px solid #e8e8e8;
    margin-bottom: 2px;
  }
  .gt-total-row .gt-label { color: #666; font-size: 9px; }
  .gt-breakdown-row {
    width: 100%;
    border-top: 1px solid #2a2a2a;
    margin-top: 10px;
    padding: 8px 0;
    text-align: center;
  }
  .gt-breakdown-btn {
    background: none;
    border: none;
    color: #888;
    font-family: 'Montserrat', sans-serif;
    font-size: 10px;
    font-weight: 600;
    letter-spacing: 1px;
    text-transform: uppercase;
    cursor: pointer;
    padding: 0;
    transition: color 0.15s;
    display: inline-flex;
    align-items: center;
    gap: 5px;
  }
  .gt-breakdown-btn:hover { color: #fff; }
  .gt-breakdown-btn .arrow {
    display: inline-block;
    transition: transform 0.25s;
    font-style: normal;
  }
  .gt-breakdown-btn.open .arrow { transform: rotate(180deg); }

  /* ‚îÄ‚îÄ Breakdown panel ‚îÄ‚îÄ */
  .pricing-breakdown {
    overflow: hidden;
    max-height: 0;
    transition: max-height 0.35s ease;
  }
  .pricing-breakdown.open { max-height: 600px; }

  /* ‚îÄ‚îÄ Pricing Breakdown ‚îÄ‚îÄ */
  .pricing-grid { display: grid; grid-template-columns: 1fr; gap: 14px; margin-top: 18px; }
  @media (min-width: 480px) { .pricing-grid { grid-template-columns: 1fr 1fr; } }
  .price-box { border: 1px solid #ddd; }
  .price-box-title {
    font-size: 9px;
    font-weight: 700;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    background: #f2f2f2;
    padding: 10px 12px;
    border-bottom: 1px solid #ddd;
    text-align: center;
  }
  .price-row { display: flex; justify-content: space-between; padding: 7px 12px; border-bottom: 1px solid #f0f0f0; font-size: 11px; }
  .price-row:last-child { border-bottom: none; }
  .price-row.total-row { background: #f2f2f2; font-weight: 700; font-size: 12px; border-top: 1px solid #ddd; border-bottom: none; }
  .price-row .lbl { color: #444; }
  .price-row .val { font-weight: 600; white-space: nowrap; padding-left: 8px; }
  .price-pp { font-size: 10px; color: #757575; padding: 5px 12px 8px; background: #f8f8f8; border-top: 1px solid #eee; text-align: center; font-weight: 600; }
  .tax-note { text-align: center; font-size: 10px; color: #757575; margin-top: 14px; line-height: 1.7; }

  /* ‚îÄ‚îÄ CTA Buttons ‚îÄ‚îÄ */
  .cta-buttons { display: grid; grid-template-columns: 1fr; gap: 10px; }
  @media (min-width: 480px) { .cta-buttons { grid-template-columns: 1fr 1fr; } }
  .cta-btn {
    display: block;
    background: #000;
    color: #fff;
    font-family: 'Montserrat', sans-serif;
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    text-align: center;
    text-decoration: none;
    padding: 16px 10px;
    border: none;
    cursor: pointer;
    transition: opacity 0.2s;
  }
  .cta-btn:hover { opacity: 0.82; color: #fff; }
  .video-wrapper {
    position: relative;
    padding-top: 56.25%;
    width: 100%;
    margin-top: 16px;
    border-radius: 10px;
    overflow: hidden;
  }
  .video-wrapper iframe {
    position: absolute;
    top: 0; left: 0;
    width: 100%;
    height: 100%;
    border: 0;
  }

  /* Google Badge */
  .google-badge {
    display: flex;
    align-items: center;
    gap: 10px;
    background: #fff;
    border: 1px solid #e8e8e8;
    border-radius: 10px;
    padding: 12px 16px;
    margin-bottom: 12px;
    text-decoration: none;
  }
  .google-badge img {
    height: 28px;
    width: auto;
  }
  .google-badge-text {
    display: flex;
    flex-direction: column;
    gap: 2px;
  }
  .google-badge-rating {
    font-size: 15px;
    font-weight: 700;
    color: #333;
    display: flex;
    align-items: center;
    gap: 6px;
  }
  .google-badge-stars {
    color: #fbbc04;
    font-size: 15px;
    letter-spacing: 1px;
  }
  .google-badge-count {
    font-size: 12px;
    color: #888;
  }

  .edit-field-btn {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 13px;
    color: #bbb;
    padding: 0 4px;
    vertical-align: middle;
    line-height: 1;
  }
  .edit-field-btn:hover { color: #c9a84c; }
  .people-editor {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    vertical-align: middle;
  }
  .people-stepper {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    background: #f5f5f5;
    border-radius: 20px;
    padding: 3px 10px;
    font-size: 13px;
  }
  .people-stepper button {
    background: none;
    border: none;
    cursor: pointer;
    font-size: 16px;
    color: #c9a84c;
    font-weight: 700;
    padding: 0 2px;
    line-height: 1;
  }
  .people-stepper span {
    min-width: 20px;
    text-align: center;
    font-weight: 600;
    color: #333;
  }
  .save-status {
    font-size: 11px;
    color: #aaa;
    display: inline-block;
    margin-left: 4px;
  }
  .save-status.saving { color: #c9a84c; }
  .save-status.saved { color: #4caf50; }
  .save-status.error { color: #e53935; }

  /* Event time editor */
  .event-edit-btn {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0 3px;
    vertical-align: middle;
    opacity: 0.4;
    line-height: 1;
  }
  .event-edit-btn:hover { opacity: 1; }
  .event-editor {
    display: none;
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 10px;
    padding: 12px 14px;
    margin-top: 8px;
    margin-left: 0;
    box-shadow: 0 2px 8px rgba(0,0,0,0.08);
  }
  .event-editor.open { display: block; }
  .event-editor label {
    font-size: 11px;
    font-weight: 700;
    color: #888;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    display: block;
    margin-bottom: 4px;
  }
  .event-editor select {
    width: 100%;
    padding: 8px 10px;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 13px;
    color: #333;
    margin-bottom: 10px;
    background: #fafafa;
  }
  .event-editor-actions {
    display: flex;
    gap: 8px;
    align-items: center;
  }
  .event-save-btn {
    background: #c9a84c;
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 7px 16px;
    font-size: 13px;
    font-weight: 700;
    cursor: pointer;
  }
  .event-cancel-btn {
    background: none;
    border: none;
    color: #aaa;
    font-size: 13px;
    cursor: pointer;
  }
  .event-save-status {
    font-size: 11px;
    margin-left: 4px;
  }
  .event-save-status.saving { color: #c9a84c; }
  .event-save-status.saved { color: #4caf50; }
  .event-save-status.error { color: #e53935; }

  /* Reviews Carousel */
  .reviews-carousel {
    margin-top: 0;
    overflow: hidden;
    position: relative;
  }
  .reviews-track {
    display: flex;
    transition: transform 0.4s ease;
  }
  .review-card {
    min-width: 100%;
    background: #fff;
    border: 1px solid #e8e8e8;
    border-radius: 12px;
    padding: 20px;
    box-sizing: border-box;
  }
  .review-stars {
    color: #fbbc04;
    font-size: 18px;
    margin-bottom: 8px;
  }
  .review-text {
    font-size: 14px;
    color: #333;
    line-height: 1.6;
    margin-bottom: 14px;
  }
  .review-author {
    font-size: 13px;
    color: #888;
    font-weight: 600;
  }
  .review-source {
    font-size: 12px;
    color: #aaa;
  }
  .carousel-dots {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-top: 14px;
  }
  .carousel-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #ddd;
    cursor: pointer;
    border: none;
    padding: 0;
    transition: background 0.2s;
  }
  .carousel-dot.active {
    background: #c9a84c;
  }

  /* ‚îÄ‚îÄ Next Steps ‚îÄ‚îÄ */
  .steps-list { list-style: none; }
  .step-item { display: flex; gap: 16px; margin-bottom: 14px; align-items: flex-start; }
  .step-num { width: 28px; height: 28px; border: 2px solid #000; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 700; flex-shrink: 0; margin-top: 1px; }
  .step-title { font-size: 13px; font-weight: 700; margin-bottom: 5px; }
  .step-desc { font-size: 12px; color: #444; line-height: 1.65; }

  /* ‚îÄ‚îÄ Property Grid ‚îÄ‚îÄ */
  .upgrades-intro { font-size: 12px; font-style: italic; color: #444; text-align: center; margin-bottom: 12px; line-height: 1.6; }
  .property-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
  .property-card { border: 1px solid #ddd; }
  .property-card.selected { border: 2px solid #000; }
  .property-selected-badge { background: #000; color: #fff; font-size: 9px; font-weight: 700; letter-spacing: 1px; text-transform: uppercase; text-align: center; padding: 5px; }
  .property-title { font-size: 10px; font-weight: 700; letter-spacing: 0.3px; padding: 8px 8px 3px; text-transform: uppercase; line-height: 1.3; }
  .property-img { width: 100%; aspect-ratio: 1; object-fit: cover; }
  .property-specs { font-size: 9px; color: #0000EE; padding: 5px 8px 8px; line-height: 1.5; }

  /* ‚îÄ‚îÄ Activity Grids ‚îÄ‚îÄ */
  .section-intro { font-size: 12px; font-style: italic; color: #444; text-align: center; margin-bottom: 16px; line-height: 1.65; }
  .activity-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
  @media (min-width: 480px) { .activity-grid { gap: 14px; } }
  .activity-card { text-align: center; }
  .activity-img { width: 100%; aspect-ratio: 1; object-fit: cover; margin-bottom: 6px; }
  .activity-name { font-size: 8px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.5px; line-height: 1.35; margin-bottom: 2px; }
  @media (min-width: 480px) { .activity-name { font-size: 9px; } }
  .activity-price { font-size: 9px; color: #555; font-weight: 500; }

  /* ‚îÄ‚îÄ Policy ‚îÄ‚îÄ */
  .policy-section { padding: 28px 0 20px; }
  .policy-divider { text-align: center; color: #bbb; font-size: 10px; margin-bottom: 14px; letter-spacing: 2px; }
  .policy-title { font-family: Georgia, serif; font-size: 10px; letter-spacing: 2px; text-transform: uppercase; text-align: center; margin-bottom: 14px; }
  .policy-text { font-size: 10px; color: #757575; text-align: center; line-height: 1.75; }

  /* ‚îÄ‚îÄ Footer ‚îÄ‚îÄ */
  .footer { text-align: center; padding: 22px 20px 40px; border-top: 1px solid #e0e0e0; }
  .footer-logo { font-size: 24px; font-weight: 900; margin-bottom: 7px; }
  .footer-info { font-size: 11px; color: #757575; line-height: 1.9; }
  .footer-info a { color: #0000EE; }

  /* ‚îÄ‚îÄ Sticky Contact Bar ‚îÄ‚îÄ */
  .contact-bar {
    position: fixed;
    bottom: 0; left: 0; right: 0;
    background: #111;
    border-top: 1px solid #333;
    display: flex;
    z-index: 100;
    height: 56px;
  }
  .contact-btn {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 8px 0;
    font-size: 10px;
    font-weight: 600;
    color: #aaa;
    letter-spacing: 0.3px;
    text-decoration: none;
    transition: color 0.15s;
    border: none;
    background: none;
    cursor: pointer;
    font-family: 'Montserrat', sans-serif;
  }
  .contact-btn:hover { color: #fff; }
  .contact-btn .icon { font-size: 18px; margin-bottom: 2px; }
  .contact-btn + .contact-btn { border-left: 1px solid #333; }
</style>
</head>
<body>

<!-- HERO -->
<div class="hero">
  <img src="/static/pdf-images/pdf-img-000.png" alt="Connected Montreal ‚Äî Making Bachelor Parties Epic Since 2012">
</div>

<!-- AS SEEN IN -->
<div class="press-section">
  <div class="press-label">As Seen In</div>
  <div class="press-logos">
    <img src="/static/pdf-images/pdf-img-011.png" alt="Eater">
    <img src="/static/pdf-images/pdf-img-022.png" alt="Fast Company">
    <img src="/static/pdf-images/pdf-img-033.png" alt="Vice">
  </div>
</div>

<!-- CLIENT INTRO -->
<div class="client-intro">
  <div class="client-name">{{ first }} {{ last }}</div>
  <div class="client-meta">
    Starting on: {{ doa }}<br>
    For <span class="people-editor">
      <span id="peopleDisplay">{{ people }}</span>
      <button class="edit-field-btn" title="Edit" onclick="startEditPeople()">‚úèÔ∏è</button>
      <span class="people-stepper" id="peopleStepper" style="display:none;">
        <button onclick="changePeople(-1)">‚àí</button>
        <span id="peopleVal">{{ people }}</span>
        <button onclick="changePeople(1)">+</button>
        <button onclick="submitPeople()" style="background:#c9a84c;color:#fff;border-radius:12px;padding:2px 10px;font-size:12px;font-weight:700;margin-left:4px;">Update</button>
      </span>
      <span class="save-status" id="saveStatus"></span>
    </span> people
  </div>
  <div class="client-note">
    <div class="note-label">üìã A note before you scroll</div>
    <ul>
      <li><span class="note-bullet">‚Ä¢</span> <span>At this stage it's more important to figure out the macro details of the trip.</span></li>
      <li><span class="note-bullet">‚Ä¢</span> <span>We will plan the Itinerary together so don't worry if you don't have all the final details right now.</span></li>
      <li><span class="note-bullet">‚Ä¢</span> <span>You have up to <strong>1 week before arrival</strong> (after booking) to make any changes, giving you the flexibility to easily add or drop events.</span></li>
    </ul>
  </div>
</div>

<div class="container">

  <!-- ACCOMMODATIONS -->
  <div class="section">
    <div class="section-title">Accommodations</div>
    <div class="accom-heading">{{ accom_name }}{% if nights %} ‚Äî {{ nights }} Nights{% endif %}{% if checkin %} &nbsp;|&nbsp; Check In: {{ checkin }}{% endif %}{% if checkout %} &nbsp;|&nbsp; Check Out: {{ checkout }}{% endif %}</div>

    <!-- House stats -->
    {% if accom_bedrooms or accom_beds or accom_bathrooms %}
    <div class="accom-stats">
      {% if accom_bedrooms %}<span>üõè {{ accom_bedrooms }} Bedrooms</span>{% endif %}
      {% if accom_beds %}<span>{{ accom_beds }} Beds</span>{% endif %}
      {% if accom_bathrooms %}<span>üöø {{ accom_bathrooms }} Bathrooms</span>{% endif %}
    </div>
    {% endif %}

    <!-- Address + PDF link -->
    <div class="accom-sub">
      {% if accom_desc %}{{ accom_desc }}<br>{% endif %}
      {% if accom_addr %}
        <a href="{{ accom_maps_url }}" target="_blank">üìç {{ accom_addr }}</a>
        {% if accom_pdf %} &nbsp;¬∑&nbsp; {% endif %}
      {% endif %}
      {% if accom_pdf %}<a href="{{ accom_pdf }}" target="_blank">More pics &amp; details ‚Üí</a>{% endif %}
    </div>

    {% if accom_photo_url %}
    <a href="{{ accom_pdf or accom_maps_url or '#' }}" target="_blank">
      <img class="accom-img" src="{{ accom_photo_url }}" alt="{{ accom_name }}">
    </a>
    {% endif %}
  </div>

  <!-- SERVICES -->
  <div class="section">
    <div class="section-title bordered">Services</div>

    {% if services_list %}
    <div class="service-block">
      <div class="service-heading">Essential Services ‚Äî For {{ people }} People</div>
      <ul class="checklist">
        {% for item in services_list %}
        <li>{{ item }}</li>
        {% endfor %}
      </ul>
    </div>
    {% endif %}

    {% if personal_host %}
    <div class="service-block">
      <div class="service-heading">Personal Host</div>
      <div class="service-body">{{ personal_host }}</div>
    </div>
    {% endif %}
  </div>

  <!-- EVENTS / ITINERARY -->
  {% if events %}
  <div class="section">
    <div class="section-title bordered">Events</div>
    {% set ns = namespace(current_day=None) %}
    {% for ev in events %}
      {% set day = ev.day_num %}
      {% if day != ns.current_day %}
        {% if ns.current_day is not none %}</div>{% endif %}
        {% set ns.current_day = day %}
        <div>
        <div class="day-header">DAY {{ day }}{% if ev.date %} ‚Äî {{ ev.date }}{% endif %}</div>
      {% endif %}
      <div class="event-row">
        <div class="event-time">
          {{ ev.start_time or '' }}
          {% if ev.record_id %}
          <button class="event-edit-btn" onclick="toggleEventEditor('{{ ev.record_id }}')" title="Edit time/day">
            <svg width="13" height="13" viewBox="0 0 24 24" fill="none" stroke="#555" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="12" cy="12" r="9"/>
              <polyline points="12 7 12 12 15 15"/>
              <line x1="17" y1="3" x2="21" y2="7"/>
              <line x1="3" y1="21" x2="7" y2="17"/>
              <line x1="17" y1="3" x2="14" y2="6"/>
              <line x1="7" y1="17" x2="10" y2="20"/>
            </svg>
          </button>
          {% endif %}
        </div>
        <div style="flex:1;">
          <div class="event-name">{{ ev.name }}{% if ev.subtitle %} ‚Äî {{ ev.subtitle }}{% endif %}</div>
          {% if ev.description %}<div class="event-desc">{{ ev.description }}</div>{% endif %}
          {% if ev.record_id %}
          <div class="event-editor" id="editor-{{ ev.record_id }}"
               data-record-id="{{ ev.record_id }}"
               data-min-time="{{ ev.min_time }}"
               data-max-time="{{ ev.max_time }}"
               data-current-time="{{ ev.start_time }}"
               data-current-day="{{ ev.day_num }}">
            <label>Time</label>
            <div style="display:flex;gap:8px;margin-bottom:10px;">
              <select id="hour-{{ ev.record_id }}" style="flex:1;padding:8px 10px;border:1px solid #ddd;border-radius:8px;font-size:13px;color:#333;background:#fafafa;"></select>
              <select id="min-{{ ev.record_id }}" style="width:80px;padding:8px 10px;border:1px solid #ddd;border-radius:8px;font-size:13px;color:#333;background:#fafafa;">
                <option value="00">:00</option>
                <option value="15">:15</option>
                <option value="30">:30</option>
                <option value="45">:45</option>
              </select>
            </div>
            {% if ev.quantity %}
            {% if ev.quantity_type == 'performers' %}
              {% set qty_label = '# of Girls' %}
              {% set qty_min = 1 %}
              {% set qty_max = 10 %}
            {% elif ev.quantity_type == 'bottles' %}
              {% set qty_label = '# of Bottles' %}
              {% set qty_min = [1, (ev.quantity_default | int) - 1] | max %}
              {% set qty_max = 20 %}
            {% else %}
              {% set qty_label = '# of People' %}
              {% set qty_min = 1 %}
              {% set qty_max = 30 %}
            {% endif %}
            <label>{{ qty_label }}</label>
            <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
              <button type="button" onclick="stepField('qty-{{ ev.record_id }}', -1, {{ qty_min }}, {{ qty_max }})" style="width:28px;height:28px;border-radius:50%;border:1px solid #ddd;background:#f5f5f5;font-size:16px;font-weight:700;cursor:pointer;color:#c9a84c;">‚àí</button>
              <span id="qty-{{ ev.record_id }}" data-value="{{ ev.quantity }}" style="min-width:30px;text-align:center;font-weight:700;font-size:15px;">{{ ev.quantity }}</span>
              <button type="button" onclick="stepField('qty-{{ ev.record_id }}', 1, {{ qty_min }}, {{ qty_max }})" style="width:28px;height:28px;border-radius:50%;border:1px solid #ddd;background:#f5f5f5;font-size:16px;font-weight:700;cursor:pointer;color:#c9a84c;">+</button>
            </div>
            {% endif %}
            {% if ev.duration and ev.quantity_type != 'bottles' %}
            <label>Duration (hrs)</label>
            <div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
              <button type="button" onclick="stepField('dur-{{ ev.record_id }}', -0.5, 0.5, 8)" style="width:28px;height:28px;border-radius:50%;border:1px solid #ddd;background:#f5f5f5;font-size:16px;font-weight:700;cursor:pointer;color:#c9a84c;">‚àí</button>
              <span id="dur-{{ ev.record_id }}" data-value="{{ ev.duration }}" style="min-width:30px;text-align:center;font-weight:700;font-size:15px;">{{ ev.duration }}</span>
              <button type="button" onclick="stepField('dur-{{ ev.record_id }}', 0.5, 0.5, 8)" style="width:28px;height:28px;border-radius:50%;border:1px solid #ddd;background:#f5f5f5;font-size:16px;font-weight:700;cursor:pointer;color:#c9a84c;">+</button>
            </div>
            {% endif %}
            <label>Day</label>
            <select id="day-{{ ev.record_id }}">
              {% for d in range(1, total_days + 1) %}
              <option value="{{ d }}" {% if d == ev.day_num %}selected{% endif %}>
                Day {{ d }}{% if day_dates.get(d) %} ‚Äî {{ day_dates.get(d) }}{% endif %}
              </option>
              {% endfor %}
            </select>
            <div class="event-editor-actions">
              <button class="event-save-btn" onclick="saveEventEdit('{{ ev.record_id }}')">Update</button>
              <button class="event-cancel-btn" onclick="toggleEventEditor('{{ ev.record_id }}')">Cancel</button>
              <span class="event-save-status" id="status-{{ ev.record_id }}"></span>
            </div>
          </div>
          {% endif %}
        </div>
      </div>
    {% endfor %}
    {% if ns.current_day is not none %}</div>{% endif %}
  </div>
  {% endif %}

  <!-- PRICING -->
  <div class="section">
    <div class="grand-total-box">
      <div>
        <div class="gt-label">Cost Per Person $USD</div>
        <div class="gt-value">{{ per_person }}</div>
      </div>
      <div class="gt-breakdown-row">
        <button class="gt-breakdown-btn" id="breakdownBtn" onclick="toggleBreakdown()">
          View Breakdown <i class="arrow">‚ñæ</i>
        </button>
      </div>
    </div>

    <div class="pricing-breakdown" id="pricingBreakdown">
      <div class="gt-total-row">
        <span class="gt-label" style="color:#666;">Grand Total $USD</span>
        <span class="gt-value-sm">{{ grand_total }}</span>
      </div>
      <div class="pricing-grid" style="margin-top:14px;">
        <div class="price-box">
          <div class="price-box-title">Accommodation Breakdown</div>
          <div class="price-row"><span class="lbl">Subtotal</span><span class="val">{{ accom_subtotal }}</span></div>
          {% if accom_hst and accom_hst != '‚Äî' %}<div class="price-row"><span class="lbl">GST 5%</span><span class="val">{{ accom_hst }}</span></div>{% endif %}
          {% if accom_qst and accom_qst != '‚Äî' %}<div class="price-row"><span class="lbl">QST</span><span class="val">{{ accom_qst }}</span></div>{% endif %}
          {% if accom_hosp_tax and accom_hosp_tax != '‚Äî' %}<div class="price-row"><span class="lbl">Hospitality Tax</span><span class="val">{{ accom_hosp_tax }}</span></div>{% endif %}
          {% if accom_cleaning and accom_cleaning != '‚Äî' %}<div class="price-row"><span class="lbl">Cleaning Fee</span><span class="val">{{ accom_cleaning }}</span></div>{% endif %}
          {% if accom_cc_fee and accom_cc_fee != '‚Äî' %}<div class="price-row"><span class="lbl">CC Fee</span><span class="val">{{ accom_cc_fee }}</span></div>{% endif %}
          <div class="price-row total-row"><span class="lbl">Total $USD</span><span class="val">{{ accom_total }}</span></div>
          {% if accom_pp %}<div class="price-pp">Per Person: {{ accom_pp }}</div>{% endif %}
        </div>

        <div class="price-box">
          <div class="price-box-title">Service Breakdown</div>
          <div class="price-row"><span class="lbl">Subtotal</span><span class="val">{{ service_subtotal }}</span></div>
          {% if service_hst and service_hst != '‚Äî' %}<div class="price-row"><span class="lbl">GST 5%</span><span class="val">{{ service_hst }}</span></div>{% endif %}
          {% if service_qst and service_qst != '‚Äî' %}<div class="price-row"><span class="lbl">QST</span><span class="val">{{ service_qst }}</span></div>{% endif %}
          {% if service_cc_fee and service_cc_fee != '‚Äî' %}<div class="price-row"><span class="lbl">CC Fee</span><span class="val">{{ service_cc_fee }}</span></div>{% endif %}
          <div class="price-row total-row"><span class="lbl">Service Cost Total $USD</span><span class="val">{{ service_total }}</span></div>
          {% if service_pp %}<div class="price-pp">Per Person: {{ service_pp }}</div>{% endif %}
        </div>
      </div>

      <div class="tax-note">
        GST/TPS # 816342489RT0001 &nbsp;&nbsp;|&nbsp;&nbsp; QST/TVQ # 1218929652TQ0001
      </div>
    </div>
  </div>

  <!-- WHAT WE DO -->
  <div class="section">
    <div class="section-title bordered">What We Do?</div>
    <a class="google-badge" href="https://www.google.com/search?q=Connected+Montreal+bachelor+party+reviews" target="_blank" rel="noopener">
      <img src="https://www.gstatic.com/images/branding/product/2x/googleg_48dp.png" alt="Google" />
      <div class="google-badge-text">
        <div class="google-badge-rating">
          <span>4.9</span>
          <span class="google-badge-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</span>
        </div>
        <div class="google-badge-count">388 Google reviews</div>
      </div>
    </a>
    <div class="reviews-carousel">
      <div class="reviews-track" id="reviewsTrack">
        <div class="review-card">
          <div class="review-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <div class="review-text">"These guys were absolutely amazing ‚Äî extremely helpful and responsive with everything we needed. They handled all the details, booked our tables, told us exactly where to go, and made sure we were always right in the middle of the action. 10/10 experience ‚Äî highly recommend for any bachelor party looking to do it right!"</div>
          <div class="review-author">Google Review</div>
          <div class="review-source">‚≠ê 5/5 on Google</div>
        </div>
        <div class="review-card">
          <div class="review-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <div class="review-text">"Oren and his services were fantastic. Do not hesitate ‚Äî this service is 100% worth it and they make sure you have a great time and get everything you need. Would recommend to anyone!"</div>
          <div class="review-author">Google Review</div>
          <div class="review-source">‚≠ê 5/5 on Google</div>
        </div>
        <div class="review-card">
          <div class="review-stars">‚òÖ‚òÖ‚òÖ‚òÖ‚òÖ</div>
          <div class="review-text">"Worth every penny! Our group of nine had no idea what to expect and Oren set everything up beforehand. The dinner, the clubs ‚Äî it all lived up to our expectations. All the events were pre-arranged, we just needed to show up and have a good time. 10/10 would do it again!"</div>
          <div class="review-author">Google Review</div>
          <div class="review-source">‚≠ê 5/5 on Google</div>
        </div>
      </div>
      <div class="carousel-dots">
        <button class="carousel-dot active" onclick="goToReview(0)"></button>
        <button class="carousel-dot" onclick="goToReview(1)"></button>
        <button class="carousel-dot" onclick="goToReview(2)"></button>
      </div>
    </div>
    <div class="video-wrapper">
      <iframe title="vimeo-player" src="https://player.vimeo.com/video/340045607?h=091febe4f8" frameborder="0" referrerpolicy="strict-origin-when-cross-origin" allow="autoplay; fullscreen; picture-in-picture; clipboard-write; encrypted-media; web-share" allowfullscreen></iframe>
    </div>
  </div>

  <!-- NEXT STEPS -->
  <div class="section">
    <div class="section-title bordered">Next Steps</div>
    <ul class="steps-list">
      <li class="step-item">
        <div class="step-num">1</div>
        <div>
          <div class="step-title">Book Your Spot With Us</div>
          <div class="step-desc">
            We are a boutique operation and take a limited number of groups, a <strong>$500.00 deposit</strong> for the entertainment
            {% if accom_downpay and accom_downpay != '‚Äî' %}and half of the accommodation fee <strong>{{ accom_downpay }}</strong> (if applicable){% endif %}
            is needed to book.<br>
            {% if down_payment and down_payment != '‚Äî' %}Your total down payment is: <strong>{{ down_payment }}</strong>.<br><br>{% endif %}
            {% if cad_form %}<a href="{{ cad_form }}" target="_blank">‚Üí This is your personal PAYMENT LINK</a>{% endif %}
          </div>
        </div>
      </li>
      <li class="step-item">
        <div class="step-num">2</div>
        <div>
          <div class="step-title">Set Up A Call With Your Reservation Specialist</div>
          <div class="step-desc">This Is Where The Sausage Is Made: Detailed Itinerary, Reservation Confirmations And Payment. Your Reservation Specialist Is There To Provide Support From The Time Of Booking Until You Arrive Into Town.</div>
        </div>
      </li>
      <li class="step-item">
        <div class="step-num">3</div>
        <div>
          <div class="step-title">Arrive Into Town</div>
          <div class="step-desc">Have A Hassle Free Weekend. From In-town Support To Game Time Audibles ‚Äî We Will Make Sure The Party Goes On Uninterrupted.</div>
        </div>
      </li>
    </ul>
  </div>

  <!-- UPGRADES & OPTIONS -->
  <div class="section">
    <div class="section-title bordered">Upgrades and Options</div>
    <div class="upgrades-intro">
      Did you know that Airbnb has a no party policy?<br><br>
      We have houses built specifically for bachelor parties in downtown Montreal. No need to worry about lame Airbnb hosts who don't like noise or a poor location.<br><br>
      These are the best options:
    </div>
    <div class="property-grid">
      <div class="property-card">
        <div class="property-title">Montreal Bachelor Party Pad (Details)</div>
        <img class="property-img" src="/static/pdf-images/pdf-img-040.png" alt="Montreal Bachelor Party Pad">
        <div class="property-specs">5 Bedrooms, 13 Beds, 2.5 Bath, 3 Floors, 5000 sq. ft.</div>
      </div>
      <div class="property-card selected">
        <div class="property-selected-badge">‚úì Your Selection</div>
        <div class="property-title">Luxury Downtown Mansion</div>
        <img class="property-img" src="/static/pdf-images/pdf-img-041.png" alt="Luxury Downtown Mansion">
        <div class="property-specs">5 Bedrooms, 12 Beds, 3.5 Bath, 4 Floors, 5500 sq. ft.</div>
      </div>
      <div class="property-card">
        <div class="property-title">House on the Main</div>
        <img class="property-img" src="/static/pdf-images/pdf-img-042.png" alt="House on the Main">
        <div class="property-specs">St. Laurent Blvd., 6 Bedrooms, 11 Beds, 3.5 Bath, 2 Floors, 2 Massive Patios, 2500 sq. ft.</div>
      </div>
      <div class="property-card">
        <div class="property-title">Modern Townhouse</div>
        <img class="property-img" src="/static/pdf-images/pdf-img-043.png" alt="Modern Townhouse">
        <div class="property-specs">4 Bedrooms, 12 Beds, 2.5 Bath, 2 Floors, Pool Table, Patio, 3000 sq. ft.</div>
      </div>
    </div>
  </div>

  <!-- DAYTIME EXPERIENCES -->
  <div class="section">
    <div class="section-title bordered">Daytime Experiences</div>
    <div class="activity-grid">
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-001.png" alt="White Water Rafting"><div class="activity-name">White Water Rafting</div><div class="activity-price">$70/PP</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-002.png" alt="Canoes and Brews"><div class="activity-name">Canoes and Brews</div><div class="activity-price">$75/PP</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-003.png" alt="Curling"><div class="activity-name">Curling (Fall &amp; Winter Only)</div><div class="activity-price">$85/PP</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-004.png" alt="Go-Karting"><div class="activity-name">Go-Karting</div><div class="activity-price">$75/PP</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-005.png" alt="Skeet Shooting"><div class="activity-name">Skeet Shooting</div><div class="activity-price">$180</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-006.png" alt="Paintball"><div class="activity-name">Paintball</div><div class="activity-price">$80/PP</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-007.png" alt="Yacht Rental"><div class="activity-name">Yacht Rental</div><div class="activity-price">MSG for Details</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-008.png" alt="Craft Brew Pub Crawl"><div class="activity-name">Craft Brew Pub Crawl</div><div class="activity-price">$75/PP</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-009.png" alt="Spa Day at Bota Bota"><div class="activity-name">Spa Day at Bota Bota</div><div class="activity-price">$90/PP</div></div>
    </div>
  </div>

  <!-- FOOD -->
  <div class="section">
    <div class="section-title bordered">Food</div>
    <div class="section-intro">Yes, we can be cultured too. Bagels, smoked meat, the Old Port, it's like sightseeing, but with better stories and fewer boring facts.</div>
    <div class="activity-grid">
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-010.png" alt="Breakfast Bagels Catering"><div class="activity-name">Breakfast Bagels Catering</div><div class="activity-price">$40/PP</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-012.png" alt="LEDs and Eggs"><div class="activity-name">LEDs and Eggs</div><div class="activity-price">Starting at $850</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-013.png" alt="Montreal Food Tour"><div class="activity-name">Montreal Food Tour</div><div class="activity-price">$75/PP</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-014.png" alt="Steakhouse Dinner"><div class="activity-name">Steakhouse Dinner</div><div class="activity-price">Starting at $85/PP</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-015.png" alt="Dinner at the Supper Club"><div class="activity-name">Dinner at the Supper Club</div><div class="activity-price">Starting at $90/PP</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-016.png" alt="Liverpool House"><div class="activity-name">Liverpool House ‚Äî Family Style Dinner</div><div class="activity-price">$120</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-017.png" alt="Personal Pit Master"><div class="activity-name">Personal Pitt Master at Rental House</div><div class="activity-price">$85/PP</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-018.png" alt="Pig or Lamb Roast"><div class="activity-name">Pig or Lamb Roast at Rental House</div><div class="activity-price">MSG for Details</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-019.png" alt="Schwartz Smoked Meat"><div class="activity-name">Schwartz Smoked Meat Slicer at Rental House</div><div class="activity-price">$1,000</div></div>
    </div>
  </div>

  <!-- OUT OF THE BOX -->
  <div class="section">
    <div class="section-title bordered">Out of the Box Ideas</div>
    <div class="activity-grid">
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-020.png" alt="Dominatrix"><div class="activity-name">Dominatrix</div><div class="activity-price">$500/HR</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-021.png" alt="Hypnotist"><div class="activity-name">Hypnotist</div><div class="activity-price">$70/2HRS</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-023.png" alt="Private Cigar Lounge"><div class="activity-name">Show at Private Cigar Lounge</div><div class="activity-price">$1,150/3 HRS</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-024.png" alt="Poker Tournament"><div class="activity-name">In House Poker Tournament</div><div class="activity-price">MSG for Details</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-025.png" alt="Montreal Casino"><div class="activity-name">Private Table Games at the Montreal Casino</div><div class="activity-price">MSG for Details</div></div>
    </div>
  </div>

  <!-- ANTI-SAUSAGE -->
  <div class="section">
    <div class="section-title bordered">Anti-Sausage Party Protective Measures</div>
    <div class="activity-grid">
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-026.png" alt="College Girl Pub Crawl"><div class="activity-name">College Girl Pub Crawl</div><div class="activity-price">$900/3 HRS</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-027.png" alt="Atmosphere Models"><div class="activity-name">Atmosphere Models at the Nightclub</div><div class="activity-price">$350/3HRS</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-028.png" alt="Female Model Golf Caddies"><div class="activity-name">Female Model Golf Caddies</div><div class="activity-price">$500</div></div>
    </div>
  </div>

  <!-- LET'S GET WILD -->
  <div class="section">
    <div class="section-title bordered">Let's Get Wild</div>
    <div class="section-intro">Brunch with the girls, beer pong battles, a little entertainment on the side‚Äîit's all tastefully wild (or wildly tasteful, depending on your morning).</div>
    <div class="activity-grid">
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-029.png" alt="Topless Beer Pong"><div class="activity-name">Topless Beer Pong</div><div class="activity-price">$850/2 HRS</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-030.png" alt="Private Dance Show"><div class="activity-name">Private Dance Show</div><div class="activity-price">$700/HR for 2 Girls</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-031.png" alt="Limousine Pick Up"><div class="activity-name">Limousine Pick Up w/ Dancers</div><div class="activity-price">$1,200+</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-032.png" alt="Naked Sushi"><div class="activity-name">Naked Sushi</div><div class="activity-price">$2,000 for up to 10 guests</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-034.png" alt="Brisket and Breast"><div class="activity-name">Brisket and Breast</div><div class="activity-price">$1,000+</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-035.png" alt="Jello Wrestling"><div class="activity-name">Jello Wrestling</div><div class="activity-price">$2,500</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-036.png" alt="Topless Poker"><div class="activity-name">Topless Poker</div><div class="activity-price">$500 for 2 Hours</div></div>
      <div class="activity-card"><img class="activity-img" src="/static/pdf-images/pdf-img-037.png" alt="Cigars, Dancers and Scotch"><div class="activity-name">Cigars, Dancers and Scotch</div><div class="activity-price">$1,200</div></div>
    </div>
  </div>

  <!-- CANCELLATION POLICY -->
  <div class="policy-section">
    <div class="policy-divider">‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî ‚Äî</div>
    <div class="policy-title">Cancellation ‚Äî Substitution ‚Äî Booking Policy</div>
    <div class="policy-text">
      All deposits are non-refundable. Final payment is due in full 7 days prior to arrival. House rental deposit is 50% and non-refundable. Substitutions or cancellations of package items are credited 50% towards another service/item. 48hr cancellation policy for daytime activities. No refunds for unused services/items (bottles, strippers, daytime activities). No refunds are given for those who are unable to attend due to weather, no-show or being denied entry at the border.
    </div>
  </div>

</div><!-- /container -->

<!-- FOOTER -->
<div class="footer">
  <div class="footer-logo">C</div>
  <div class="footer-info">
    3414 Park Ave, Montreal, Quebec H2X 2H5<br>
    +1 877-690-4919<br>
    <a href="https://connectedmontreal.com" target="_blank">connectedmontreal.com</a>
  </div>
</div>

<!-- STICKY CONTACT BAR -->
<div class="contact-bar">
  <a class="contact-btn" href="sms:+15143496565">
    <span class="icon">üí¨</span>Text Us
  </a>
  <a class="contact-btn" href="mailto:Oren@connectedmontreal.com">
    <span class="icon">‚úâÔ∏è</span>Email
  </a>
  <button class="contact-btn" onclick="shareQuote()">
    <span class="icon">üîó</span>Share
  </button>
</div>

<script>
  function parseTimeMins(t) {
    if (!t) return null;
    t = t.trim();
    var m = t.match(/^(\d+):(\d+)\s*(AM|PM)$/i);
    if (!m) return null;
    var h = parseInt(m[1]), min = parseInt(m[2]), ampm = m[3].toUpperCase();
    if (ampm === 'PM' && h !== 12) h += 12;
    if (ampm === 'AM' && h === 12) h = 0;
    return h * 60 + min;
  }
  function formatHour(h) {
    var ampm = h >= 12 ? 'PM' : 'AM';
    var h12 = h % 12 || 12;
    return h12 + ' ' + ampm;
  }
  function buildHourOptions(minTime, maxTime, currentTime) {
    var minM = parseTimeMins(minTime) || parseTimeMins('10:00 AM');
    var maxM = parseTimeMins(maxTime) || parseTimeMins('11:00 PM');
    // Handle past-midnight max (e.g. 2:00 AM as end of night)
    if (maxM < minM) maxM += 24 * 60;
    var minH = Math.floor(minM / 60);
    var maxH = Math.floor(maxM / 60);
    var currentH = null;
    if (currentTime) {
      var cm = parseTimeMins(currentTime);
      if (cm !== null) {
        currentH = Math.floor(cm / 60);
        if (currentH < minH) currentH += 24;
      }
    }
    var opts = [];
    for (var h = minH; h <= maxH; h++) {
      var displayH = h % 24;
      var ampm = displayH >= 12 ? 'PM' : 'AM';
      var h12 = displayH % 12 || 12;
      opts.push({ value: displayH, label: h12 + ' ' + ampm, selected: currentH === h });
    }
    return opts;
  }
  function toggleEventEditor(recId) {
    var editor = document.getElementById('editor-' + recId);
    if (!editor) return;
    var isOpen = editor.classList.contains('open');
    document.querySelectorAll('.event-editor.open').forEach(function(e) { e.classList.remove('open'); });
    if (!isOpen) {
      var minTime = editor.dataset.minTime;
      var maxTime = editor.dataset.maxTime;
      var currentTime = editor.dataset.currentTime;
      var hourSel = document.getElementById('hour-' + recId);
      var minSel = document.getElementById('min-' + recId);
      hourSel.innerHTML = '';
      buildHourOptions(minTime, maxTime, currentTime).forEach(function(o) {
        var opt = document.createElement('option');
        opt.value = o.value;
        opt.textContent = o.label;
        if (o.selected) opt.selected = true;
        hourSel.appendChild(opt);
      });
      // Set current minutes
      if (currentTime) {
        var cm = parseTimeMins(currentTime);
        if (cm !== null) {
          var curMin = cm % 60;
          var rounded = [0,15,30,45].reduce(function(a,b) { return Math.abs(b-curMin)<Math.abs(a-curMin)?b:a; });
          minSel.value = String(rounded).padStart(2,'0');
        }
      }
      editor.classList.add('open');
    }
  }
  function getSelectedTime(recId) {
    var hourSel = document.getElementById('hour-' + recId);
    var minSel = document.getElementById('min-' + recId);
    var h = parseInt(hourSel.value);
    var min = parseInt(minSel.value);
    var ampm = h >= 12 ? 'PM' : 'AM';
    var h12 = h % 12 || 12;
    return h12 + ':' + String(min).padStart(2,'0') + ' ' + ampm;
  }
  function stepField(elId, delta, min, max) {
    var el = document.getElementById(elId);
    var cur = parseFloat(el.dataset.value) || 0;
    var next = Math.min(max, Math.max(min, cur + delta));
    next = Math.round(next * 10) / 10; // avoid float weirdness
    el.dataset.value = next;
    el.textContent = next;
  }
  function saveEventEdit(recId) {
    var time = getSelectedTime(recId);
    var day = parseInt(document.getElementById('day-' + recId).value);
    var qtyEl = document.getElementById('qty-' + recId);
    var durEl = document.getElementById('dur-' + recId);
    var status = document.getElementById('status-' + recId);
    status.className = 'event-save-status saving';
    status.textContent = 'Saving...';
    var payload = {event_id: recId, start_time: time, day_num: day};
    if (qtyEl) payload.quantity = parseFloat(qtyEl.dataset.value);
    if (durEl) payload.duration = parseFloat(durEl.dataset.value);
    var token = window.location.pathname.split('/')[2];
    fetch('/quote/' + token + '/update-event', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify(payload)
    })
    .then(function(r) { return r.json(); })
    .then(function(data) {
      if (data.ok) {
        status.className = 'event-save-status saved';
        status.textContent = '‚úì Saved';
        setTimeout(function() { location.reload(); }, 800);
      } else {
        status.className = 'event-save-status error';
        status.textContent = '‚úó Error';
      }
    })
    .catch(function() {
      status.className = 'event-save-status error';
      status.textContent = '‚úó Error';
    });
  }
</script>

<script>
function toggleBreakdown() {
  var panel = document.getElementById('pricingBreakdown');
  var btn   = document.getElementById('breakdownBtn');
  var open  = panel.classList.toggle('open');
  btn.classList.toggle('open', open);
  btn.innerHTML = open
    ? 'Hide Breakdown <i class="arrow" style="display:inline-block;transform:rotate(180deg)">‚ñæ</i>'
    : 'View Breakdown <i class="arrow">‚ñæ</i>';
}

function shareQuote() {
  const url = "{{ current_url }}";
  if (navigator.share) {
    navigator.share({ title: "My Montreal Bachelor Party Quote", url: url })
      .catch(() => copyToClipboard(url));
  } else {
    copyToClipboard(url);
  }
}
function copyToClipboard(url) {
  navigator.clipboard.writeText(url).then(() => {
    alert("Link copied to clipboard!");
  }).catch(() => {
    prompt("Copy this link:", url);
  });
}

var reviewIndex = 0;
function goToReview(n) {
  reviewIndex = n;
  document.getElementById('reviewsTrack').style.transform = 'translateX(-' + (n * 100) + '%)';
  document.querySelectorAll('.carousel-dot').forEach(function(d, i) {
    d.classList.toggle('active', i === n);
  });
}
// Auto-advance every 5 seconds
setInterval(function() {
  goToReview((reviewIndex + 1) % 3);
}, 5000);
</script>

<script>
  var _peopleCount = parseInt('{{ people }}') || 1;
  var _savingTimeout = null;

  function startEditPeople() {
    document.getElementById('peopleDisplay').style.display = 'none';
    document.getElementById('peopleStepper').style.display = 'inline-flex';
    document.getElementById('peopleVal').textContent = _peopleCount;
  }

  function changePeople(delta) {
    var newVal = _peopleCount + delta;
    if (newVal < 2) newVal = 2;
    if (newVal > 30) newVal = 30;
    _peopleCount = newVal;
    document.getElementById('peopleVal').textContent = newVal;
  }

  function submitPeople() {
    var status = document.getElementById('saveStatus');
    status.className = 'save-status saving';
    status.textContent = 'Saving...';
    var token = window.location.pathname.split('/')[2];
    fetch('/quote/' + token + '/update-field', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({field: 'People', value: _peopleCount})
    })
    .then(function(r) { return r.json(); })
    .then(function(data) {
      if (data.ok) {
        status.className = 'save-status saved';
        status.textContent = '‚úì Saved';
        setTimeout(function() { location.reload(); }, 800);
      } else {
        status.className = 'save-status error';
        status.textContent = '‚úó Error';
      }
    })
    .catch(function() {
      status.className = 'save-status error';
      status.textContent = '‚úó Error';
    });
  }
</script>

</body>
</html>
